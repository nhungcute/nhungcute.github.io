<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Demo g·ª≠i d·ªØ li·ªáu v√†o Google Sheets</title>
</head>
<body>
  <h2>G·ª≠i d·ªØ li·ªáu</h2>
  <form id="myForm">
    <label>H·ªç t√™n: <input type="text" name="name" /></label><br />
    <label>Email: <input type="email" name="email" /></label><br />
    <button type="submit">G·ª≠i</button>
  </form>

  <p id="status"></p>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbx_Qo2PWeC_J4_AO58DdHF4DwIjfHPvZddoX_JypN2QehqHuAWMs9ml9N4DFlNaa3EF/exec';

    document.getElementById('myForm').addEventListener('submit', e => {
      e.preventDefault();
      const form = e.target;
      const data = [
        form.name.value,
        form.email.value,
        new Date().toLocaleString()
      ];

      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(data),
        headers: { 'Content-Type': 'application/json' }
      })
      .then(res => res.text())
      .then(msg => {
        document.getElementById("status").textContent = "üéâ G·ª≠i th√†nh c√¥ng!";
        form.reset();
      })
      .catch(err => {
        document.getElementById("status").textContent = "‚ùå L·ªói g·ª≠i d·ªØ li·ªáu";
        console.error("Error!", err);
      });
    });
  </script>
</body>
</html>
